{
  "hash": "169de5af55a5a234079f68302aedb93c",
  "result": {
    "markdown": "---\ntitle: \"Individual Participant Data Meta-analysis of clinical trials and real-world data\"\nauthors:   \n  - name: Pablo Verde\n    affiliations:\n      - ref: umcdusseldorf\n  - name: Thomas Debray\n    orcid: 0000-0002-1790-2719\n    affiliations:\n      - ref: smartdas\naffiliations:\n  - id: smartdas\n    name: Smart Data Analysis and Statistics B.V.\n    city: Utrecht\n  - id: umcdusseldorf\n    name: Universitätsklinikum Düsseldorf\n    city: Düsseldorf\nformat:\n  html:\n    toc: true\n    number-sections: true\nexecute:\n  cache: true\nbibliography: 'https://api.citedrive.com/bib/0d25b38b-db8f-43c4-b934-f4e2f3bd655a/references.bib?x=eyJpZCI6ICIwZDI1YjM4Yi1kYjhmLTQzYzQtYjkzNC1mNGUyZjNiZDY1NWEiLCAidXNlciI6ICIyNTA2IiwgInNpZ25hdHVyZSI6ICI0MGFkYjZhMzYyYWE5Y2U0MjQ2NWE2ZTQzNjlhMWY3NTk5MzhhNzUxZDNjYWIxNDlmYjM4NDgwOTYzMzY5YzFlIn0=/bibliography.bib'\n---\n\n\n\n\n## Introduction\n\n\n## Hierarchical Meta-Regression\nWe illustrate the implementation of hierarchical meta-regression using an example that involves the following data sources:\n\n* Aggregate data from 35 randomized trials investigating the efficacy of adjunctive treatments in managing diabetic foot problems compared with routine care\n* Individual participant data from a prospective cohort study investigating patient and limb survival in patients with diabetic foot ulcers \n\n### Aggregate data\nWe first retrieve the randomized evidence and summarize the treatment effect estimates using a random effects meta-analysis:\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-2_f7cacc4b2068e8e0b49c42b0d14818e2'}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(jarbes)\nlibrary(meta)\n\ndata(\"healing\")\n\nresults.ADJ <- metabin(event.c = y_c, n.c = n_c,\n                       event.e = y_t, n.e = n_t,\n                       studlab = Study, data = healing,\n                       sm = \"OR\", \n                       prediction = TRUE)\n```\n:::\n\n\nThe corresponding forest plot is depicted below. The endpoint is healing without amputations within a period less than or equal to 1 year.\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-3_ccb46ff31b59d1bcdf1839864e34eeb2'}\n::: {.cell-output-display}\n![](chapter_11_files/figure-html/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\nThe random effects meta-analysis yielded a pooled odds ratio of 1.90. However, substantial between-study heterogeneity was found, with $\\tau$ = 0.46.\n\n### Individual participant data\nSubsequently, we retrieve the individual participant data:\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-4_98abfdc985b108064e02e2f47ea3d856'}\n\n```{.r .cell-code}\ndata(\"healingipd\")\nIPD <- healingipd %>% dplyr::select(healing.without.amp, PAD, neuropathy,\n                                    first.ever.lesion, no.continuous.care, \n                                    male, diab.typ2, insulin, HOCHD, \n                                    HOS, CRF, dialysis, DNOAP, smoking.ever, \n                                    diabdur, wagner.class)\n```\n:::\n\n\nBriefly, these IPD were obtained from a prospective cohort study enrolling consecutive patients with diabetic foot ulcers (DFUs) and without previous major amputation in a  single diabetes center between June 1998 and December 1999 [@morbach_long-term_2012]. The baseline characteristics of the study population are summarized below:\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-5_a3fa5d48e7c6dee59e8f08278511b2b8'}\n::: {.cell-output-display}\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Healing without amputation<br><span class='stratn'>(N=165)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>No healing without amputation<br><span class='stratn'>(N=95)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=260)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Age (years)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>69.1 (10.9)</td>\n<td>68.5 (11.0)</td>\n<td>68.9 (10.9)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>70.0 [25.0, 90.0]</td>\n<td class='lastrow'>69.0 [36.0, 91.0]</td>\n<td class='lastrow'>70.0 [25.0, 91.0]</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Diabetes duration (years)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>15.9 (10.3)</td>\n<td>15.9 (11.2)</td>\n<td>15.9 (10.6)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>14.0 [1.00, 53.0]</td>\n<td class='lastrow'>14.0 [0, 50.0]</td>\n<td class='lastrow'>14.0 [0, 53.0]</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Sex</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Female</td>\n<td>71 (43.0%)</td>\n<td>35 (36.8%)</td>\n<td>106 (40.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Male</td>\n<td class='lastrow'>94 (57.0%)</td>\n<td class='lastrow'>60 (63.2%)</td>\n<td class='lastrow'>154 (59.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Ever smoker</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>97 (58.8%)</td>\n<td>57 (60.0%)</td>\n<td>154 (59.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>68 (41.2%)</td>\n<td class='lastrow'>38 (40.0%)</td>\n<td class='lastrow'>106 (40.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Diabetes type 2</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>150 (90.9%)</td>\n<td>79 (83.2%)</td>\n<td>229 (88.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>15 (9.1%)</td>\n<td class='lastrow'>16 (16.8%)</td>\n<td class='lastrow'>31 (11.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Peripheral arterial disease</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>82 (49.7%)</td>\n<td>66 (69.5%)</td>\n<td>148 (56.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>83 (50.3%)</td>\n<td class='lastrow'>29 (30.5%)</td>\n<td class='lastrow'>112 (43.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Neuropathy</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>144 (87.3%)</td>\n<td>80 (84.2%)</td>\n<td>224 (86.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>21 (12.7%)</td>\n<td class='lastrow'>15 (15.8%)</td>\n<td class='lastrow'>36 (13.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>First ever lesion</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>70 (42.4%)</td>\n<td>44 (46.3%)</td>\n<td>114 (43.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>95 (57.6%)</td>\n<td class='lastrow'>51 (53.7%)</td>\n<td class='lastrow'>146 (56.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>No continuous care</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>115 (69.7%)</td>\n<td>62 (65.3%)</td>\n<td>177 (68.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>50 (30.3%)</td>\n<td class='lastrow'>33 (34.7%)</td>\n<td class='lastrow'>83 (31.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Insulin dependent</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>109 (66.1%)</td>\n<td>65 (68.4%)</td>\n<td>174 (66.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>56 (33.9%)</td>\n<td class='lastrow'>30 (31.6%)</td>\n<td class='lastrow'>86 (33.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>History of coronary events (CHD)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>31 (18.8%)</td>\n<td>21 (22.1%)</td>\n<td>52 (20.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>134 (81.2%)</td>\n<td class='lastrow'>74 (77.9%)</td>\n<td class='lastrow'>208 (80.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>History of stroke</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>36 (21.8%)</td>\n<td>19 (20.0%)</td>\n<td>55 (21.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>129 (78.2%)</td>\n<td class='lastrow'>76 (80.0%)</td>\n<td class='lastrow'>205 (78.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Charcot foot syndrome</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>28 (17.0%)</td>\n<td>24 (25.3%)</td>\n<td>52 (20.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>137 (83.0%)</td>\n<td class='lastrow'>71 (74.7%)</td>\n<td class='lastrow'>208 (80.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Dialysis</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>3 (1.8%)</td>\n<td>6 (6.3%)</td>\n<td>9 (3.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>162 (98.2%)</td>\n<td class='lastrow'>89 (93.7%)</td>\n<td class='lastrow'>251 (96.5%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>DNOAP</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Yes</td>\n<td>19 (11.5%)</td>\n<td>10 (10.5%)</td>\n<td>29 (11.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>No</td>\n<td class='lastrow'>146 (88.5%)</td>\n<td class='lastrow'>85 (89.5%)</td>\n<td class='lastrow'>231 (88.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Wagner score</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>1-2</td>\n<td>115 (69.7%)</td>\n<td>27 (28.4%)</td>\n<td>142 (54.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>3-4-5</td>\n<td class='lastrow'>50 (30.3%)</td>\n<td class='lastrow'>68 (71.6%)</td>\n<td class='lastrow'>118 (45.4%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nAs depicted above, IPD are available from 260 patients. Some of these patients have similar characteristics to those enrolled in the randomized trials. However, other patients have comorbidities, where one or more risk factors prevent them to participate in the RCTs due to ethical reasons. For example,\n118 patients have severe ulcer lesions (Wagner score 3 to 5), and 77 patients suffer from severe ulcer lesions and peripheral arterial disease (PAD). The question is: Can we generalize the benefit of adjuvant therapies observed in the RCTs to the subgroups of patients encountered in clinical practice?\n\n### Hierarchical metaregression\nWe first investigate the event rate of patients receiving routine care:\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-6_299bf59fd3271c56f5ca3cdd40686473'}\n::: {.cell-output-display}\n![](chapter_11_files/figure-html/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\nThe forest plot above indicates that the baseline risk in the observational study from Morbach et al. is much higher than most trials.\n\n\nWe fitted an HMR model to the available RWD and published AD: \n\n\n::: {.cell hash='chapter_11_cache/html/hmr_fit_2740671afa49efcae98d1899c9eb7d7e'}\n\n```{.r .cell-code}\nset.seed(2022)\n\nAD <- healing %>% dplyr::select(yc = y_c, nc = n_c, \n                                yt = y_t, nt = n_t, Study = Study)\n\nmx2 <- hmr(data = AD,               # Published aggregate data\n           two.by.two = FALSE,      # \n           dataIPD = IPD,           # Data frame of the IPD \n           re = \"sm\",               # Random effects model: \"sm\" scale mixtures \n           link = \"logit\",          # Link function of the random effects\n           sd.mu.1 = 1,             # Scale parameter for the prior of mu.1\n           sd.mu.2 = 1,             # Scale parameter for the prior of mu.2 \n           sd.mu.phi = 1,           # Scale parameter for the prior of mu.phi \n           sigma.1.upper = 5,       # Upper bound of the prior of sigma.1  \n           sigma.2.upper = 5,       # Upper bound of the prior of sigma.2\n           sigma.beta.upper = 5,    # Upper bound of the prior of sigma.beta\n           sd.Fisher.rho = 1.25,    # Scale parameter for the prior of rho\n           df.estimate = TRUE,      # If TRUE the degrees of freedom are estimated\n           df.lower = 3,            # Lower bound of the df's prior\n           df.upper = 10,           # Upper bound of the df's prior\n           nr.chains = 2,           # Number of MCMC chains\n           nr.iterations = 10000,   # Total number of iterations\n           nr.adapt = 1000,         # Number of iteration for burnin \n           nr.thin = 1)             # Thinning rate\n```\n:::\n\n\nWe start our analysis by visualizing the conflict of evidence between the different types of data and study types. The figure below depicts the posterior distribution of $\\mu_{\\phi}$, which is the mean bias of the IPD-NRS compared to the AD-RCTs control groups. The posterior distribution has a substantial probability mass below zero, which indicates that in average the IPD-NRS patients present a better prognoses than the AD-RCTs control groups. That means that taking the IPD-NRS results at face value would be misleading if we aim to combine them with a meta-analysis of AD-RCTs.\n\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-7_81210f96c1288561a0a3bfea04a90388'}\n::: {.cell-output-display}\n![Conflict of evidence analysis. The left panel shows the prior to posterior sensitivity analysis of bias mean between the RCTs and the IPD-NRS. The right panel depicts the posterior distribution of the outliers detection weights.](chapter_11_files/figure-html/unnamed-chunk-7-1.png){width=1056}\n:::\n:::\n\n\n\nThe figure below presents the posterior distribution of the weights $w_{i}$ for each study included in the HMR. These posteriors are summarized using a forest plot, where posterior intervals substantially greater than one indicate outliers. One important aspect of the HMR is that those outliers are automatically down-weighted in the analysis.\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-8_0ed4f880870d62ff54e258dbf9d747a9'}\n::: {.cell-output-display}\n![Posterior distribution of the weights for each study included in the HMR](chapter_11_files/figure-html/unnamed-chunk-8-1.png){width=1056}\n:::\n:::\n\n\n\n## Version info {.unnumbered}\nThis chapter was rendered using the following version of R and its packages:\n\n\n::: {.cell hash='chapter_11_cache/html/unnamed-chunk-9_f05bdc3d779bf4f97e1fb47a7508a630'}\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.2.3 (2023-03-15 ucrt)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\nlocale:\n[1] LC_COLLATE=Dutch_Netherlands.utf8  LC_CTYPE=Dutch_Netherlands.utf8   \n[3] LC_MONETARY=Dutch_Netherlands.utf8 LC_NUMERIC=C                      \n[5] LC_TIME=Dutch_Netherlands.utf8    \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] meta_6.5-0       table1_1.4.3     tableone_0.13.2  dplyr_1.1.2     \n [5] jarbes_2.0.0     GGally_2.1.2     R2jags_0.7-1     rjags_4-14      \n [9] mcmcplots_0.4.3  coda_0.19-4      gridExtra_2.3    ggplot2_3.4.4   \n[13] kableExtra_1.3.4\n\nloaded via a namespace (and not attached):\n [1] nlme_3.1-162        webshot_0.5.5       RColorBrewer_1.1-3 \n [4] httr_1.4.7          numDeriv_2016.8-1.1 tools_4.2.3        \n [7] utf8_1.2.3          R6_2.5.1            R2WinBUGS_2.1-21   \n[10] metafor_4.4-0       DBI_1.1.3           colorspace_2.1-0   \n[13] withr_2.5.2         tidyselect_1.2.0    compiler_4.2.3     \n[16] cli_3.6.1           rvest_1.0.3         denstrip_1.5.4     \n[19] xml2_1.3.4          labeling_0.4.3      scales_1.2.1       \n[22] sfsmisc_1.1-16      systemfonts_1.0.4   stringr_1.5.1      \n[25] digest_0.6.31       minqa_1.2.6         rmarkdown_2.25     \n[28] svglite_2.1.1       pkgconfig_2.0.3     htmltools_0.5.5    \n[31] lme4_1.1-35.1       fastmap_1.1.1       htmlwidgets_1.6.2  \n[34] rlang_1.1.1         rstudioapi_0.15.0   shiny_1.8.0        \n[37] farver_2.1.1        generics_0.1.3      jsonlite_1.8.7     \n[40] magrittr_2.0.3      Formula_1.2-5       metadat_1.2-0      \n[43] Matrix_1.5-4.1      Rcpp_1.0.10         munsell_0.5.0      \n[46] fansi_1.0.4         abind_1.4-5         lifecycle_1.0.4    \n[49] stringi_1.7.12      yaml_2.3.7          CompQuadForm_1.4.3 \n[52] mathjaxr_1.6-0      MASS_7.3-60         plyr_1.8.8         \n[55] grid_4.2.3          parallel_4.2.3      promises_1.2.1     \n[58] miniUI_0.1.1.1      lattice_0.21-8      splines_4.2.3      \n[61] knitr_1.45          pillar_1.9.0        boot_1.3-28.1      \n[64] codetools_0.2-19    glue_1.6.2          evaluate_0.23      \n[67] mitools_2.4         vctrs_0.6.3         nloptr_2.0.3       \n[70] httpuv_1.6.12       gtable_0.3.4        purrr_1.0.1        \n[73] tidyr_1.3.0         reshape_0.8.9       xfun_0.39          \n[76] ggExtra_0.10.1      mime_0.12           xtable_1.8-4       \n[79] survey_4.2-1        later_1.3.1         survival_3.5-5     \n[82] viridisLite_0.4.2   tibble_3.2.1        ellipsis_0.3.2     \n```\n:::\n:::\n\n\n## References {.unnumbered}\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/table1-1.0/table1_defaults.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}