{
  "hash": "f2d105543fbc27b2e766e671361a2f89",
  "result": {
    "markdown": "---\ntitle: \"Effect Modification Analysis within the Propensity score Framework\"\nauthor: \"Mohammad Ehsanul Karim\"\nformat:\n  html:\n    toc: true\n    number-sections: true\neditor: visual\nexecute:\n  cache: true\n---\n\n\n\n\n## Simulation\n\nFirst, we need to install the R package `simcausal`, which can be obtained from GitHub:\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-2_4e6f515dd57a5656dc90caf5bab54e67'}\n\n```{.r .cell-code}\ndevtools::install_github('osofr/simcausal', build_vignettes = FALSE)\n```\n:::\n\n\nWe will use the following data-generation model:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-3_3ce556834b402725aeb1d9fdd5044354'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"age\", distr = \"rnorm\", \n       mean = 2, sd = 4) + \n  node(\"gender\", distr = \"rbern\", \n       prob = plogis(4)) +\n  node(\"education\", distr = \"rbern\", \n       prob = plogis(3 + 5* age)) +\n  node(\"diet\", distr = \"rbern\", \n       prob = plogis(1 -3 * education)) +\n  node(\"income\", distr = \"rbern\", \n       prob = plogis(2 - 5 * education - 4 * age)) +\n  node(\"smoking\", distr = \"rbern\", \n       prob = plogis(1 + 1.2 * gender + 2 * age)) +\n  node(\"hypertension\", distr = \"rbern\", \n       prob = plogis(1 + log(3) * diet + \n                       log(1.3) * age + \n                       log(3.5) * smoking + \n                       log(0.5) * gender))\nDset <- set.DAG(D)\nplotDAG(Dset)\n```\n\n::: {.cell-output-display}\n![](chapter_07_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nWe can now generate an example dataset:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-4_60641942739348b2ae45589a9692371c'}\n\n```{.r .cell-code}\nObs.Data <- sim(DAG = Dset, n = 50000, rndseed = 123)\n\nObs.Data$smoking <- as.character(Obs.Data$smoking)\nObs.Data$income <- as.factor(Obs.Data$income)\nObs.Data$income <- relevel(Obs.Data$income, ref = \"1\")\n```\n:::\n\n\nSample data from the hypothetical example of association between hypertension and  smoking, where other variables such as income, age [centered], gender, education and diet also plays a role in the data generation process.\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-5_de9a2919738abdf0f1b85faab7bc878c'}\n::: {.cell-output .cell-output-stdout}\n```\n            age gender education diet income smoking hypertension\n34901 12.288936      1         1    1      0       1            1\n149   10.400436      1         1    0      0       1            1\n10060  2.991820      1         1    0      0       1            0\n22220 -4.311952      0         0    0      1       0            1\n9979  -6.435549      0         0    0      1       0            1\n```\n:::\n:::\n\n\n## Effect measure assessment via adding interaction term\n\nBelow, we estimate a logistic regression model to assess whether the effect of smoking (the exposure) on hypertension is modified by income. The covariates age and gender are confounders.\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-6_26516b1d25716f598a1bd19979418142'}\n\n```{.r .cell-code}\nfit.w.em <- glm(hypertension ~ smoking * income + age + gender, \n            family = binomial(link = \"logit\"), data = Obs.Data)\n\nrequire(jtools)\nresults.model <- summ(fit.w.em, model.info = FALSE, \n                      model.fit = FALSE,\n                      exp = TRUE)\nresults.model\n```\n\n::: {.cell-output-display}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> z val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 5.46 </td>\n   <td style=\"text-align:right;\"> 4.37 </td>\n   <td style=\"text-align:right;\"> 6.82 </td>\n   <td style=\"text-align:right;\"> 14.97 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> smoking1 </td>\n   <td style=\"text-align:right;\"> 2.93 </td>\n   <td style=\"text-align:right;\"> 2.60 </td>\n   <td style=\"text-align:right;\"> 3.30 </td>\n   <td style=\"text-align:right;\"> 17.69 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> income0 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n   <td style=\"text-align:right;\"> 0.41 </td>\n   <td style=\"text-align:right;\"> 0.57 </td>\n   <td style=\"text-align:right;\"> -8.28 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.29 </td>\n   <td style=\"text-align:right;\"> 1.27 </td>\n   <td style=\"text-align:right;\"> 1.31 </td>\n   <td style=\"text-align:right;\"> 36.77 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> gender </td>\n   <td style=\"text-align:right;\"> 0.54 </td>\n   <td style=\"text-align:right;\"> 0.43 </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:right;\"> -5.55 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> smoking1:income0 </td>\n   <td style=\"text-align:right;\"> 1.27 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n   <td style=\"text-align:right;\"> 1.56 </td>\n   <td style=\"text-align:right;\"> 2.33 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: MLE</td></tr></tfoot>\n</table>\n:::\n:::\n\n\nThe interaction term in `results.model` is statistically significant.\n\n\n### Presentation of effect measures {.unnumbered}\nWe can generate a summary report from aforementioned effect modification analysis. The table below depicts the adjusted odds ratios  for income levels (`high = 0`, and `low = 1`)\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-7_453ab8129178300106059a46d4b1573d'}\n\n```{.r .cell-code}\nrequire(interactionR)\nem.object <- interactionR(fit.w.em, \n                          exposure_names = c(\"income0\", \"smoking1\"), \n                          ci.type = \"mover\", ci.level = 0.95, \n                          em = TRUE, recode = FALSE)\n\nem.object$dframe[,1:4]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                             Measures  Estimates      CI.ll      CI.ul\n1                                OR00  1.0000000         NA         NA\n2                                OR01  2.9301604  2.6010653  3.3008937\n3                                OR10  0.4832932  0.4068652  0.5740780\n4                                OR11  1.7997639  1.6334908  1.9829619\n5 OR(smoking1 on outcome [income0==0]  2.9301604  2.6010653  3.3008937\n6 OR(smoking1 on outcome [income0==1]  3.7239584  3.1434919  4.4116118\n7                Multiplicative scale  1.2709060  1.0385052  1.5553143\n8                                RERI -0.6136898 -0.9754808 -0.2905171\n```\n:::\n:::\n\n\n## Effect measure assessment via stratified approach\nThis approach involves estimating a regression model in different strata of the effect modifier `income`:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-8_0ee5f4e2e89d985b84204c47d01cd2e6'}\n\n```{.r .cell-code}\nfit.income1 <- glm(hypertension ~ smoking + age + gender, \n            family = binomial(link = \"logit\"), \n            data = subset(Obs.Data, income == 1))\nfit.income0 <- glm(hypertension ~ smoking + age + gender, \n            family=binomial(link = \"logit\"), \n            data= subset(Obs.Data, income == 0))\n```\n:::\n\n\nThe table below summarizes the adjusted odds ratios for smoking across the different income levels (`low = 1`, and `high = 0`) as obtained using the stratified approach.\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-9_411e399494dcefe15ba2c36968659b4e'}\n::: {.cell-output .cell-output-stdout}\n```\n     Value of income exp(Est.)     2.5%    97.5%   z val.            p\n[1,]               1  3.066878 2.707961 3.473366 17.64728 1.067842e-69\n[2,]               0  3.590260 3.023124 4.263792 14.57113 4.287200e-48\n```\n:::\n:::\n\n\nNote that we can obtain the same results by estimating a regression model with an interaction term between the modifier and all covariates:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-10_ba1e194bbb466a52ef4cd8e550f2ee3e'}\n\n```{.r .cell-code}\nfit.all.int <- glm(hypertension ~ income * (smoking + age + gender), \n            family = binomial(link = \"logit\"), data = Obs.Data)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-11_25ac7983aae013a3504d7a39ce080e49'}\n::: {.cell-output .cell-output-stdout}\n```\n                    Variable Units OddsRatio       CI.95 p-value\n1 income(1): smoking(1 vs 0)            3.07 [2.71;3.47] < 1e-04\n2 income(0): smoking(1 vs 0)            3.59 [3.02;4.26] < 1e-04\n```\n:::\n:::\n\n\n\n## Interaction\nAssessment of interaction between smoking and income. We estimate a logistic regression model where\n\n- Outcome: `hypertension`\n- Exposure variables: `smoking` and `income` \n- Confounders: `age`, `gender`, and `education`\n\nAn interaction term of smoking and income is added. \n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-12_98d575d510139bcc06f10cc438d842dc'}\n\n```{.r .cell-code}\nfit.w.int <- glm(hypertension ~ smoking * income + age + gender + \n                   education, family = binomial(link = \"logit\"), \n                 data = Obs.Data)\nresults.int.model <- summ(fit.w.int, model.info = FALSE, model.fit = FALSE, \n                          exp = TRUE)\nresults.int.model$coeftable\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 exp(Est.)      2.5%     97.5%     z val.             p\n(Intercept)      5.6937765 4.5570175 7.1141027 15.3077121  6.791105e-53\nsmoking1         3.3452459 2.9505339 3.7927612 18.8503257  2.920389e-79\nincome0          1.0908060 0.8506311 1.3987941  0.6849951  4.933470e-01\nage              1.2981524 1.2804814 1.3160673 37.3150071 9.371499e-305\ngender           0.5366777 0.4313229 0.6677666 -5.5815569  2.383750e-08\neducation        0.4233969 0.3502014 0.5118909 -8.8749618  6.995745e-19\nsmoking1:income0 1.1022535 0.8968615 1.3546825  0.9253438  3.547871e-01\n```\n:::\n:::\n\n\nThe interaction term between income and smoking is, however, not statistically significant.\n\n\n### Presentation of effect measures {.unnumbered}\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-13_090ff8ad38389af3dd4d8337b51f714e'}\n\n```{.r .cell-code}\nint.object = interactionR(fit.w.int, \n                          exposure_names = c(\"smoking1\", \"income0\"), \n                          ci.type = \"mover\", ci.level = 0.95, \n                          em = FALSE, recode = FALSE)\n```\n:::\n\n\nSummary report from an interaction analysis when investigating association between two exposure variables (smoking and income) and hypertension. Below, `CI.ll` and `CI.ul` depict the lower and upper limits of the 95 percent confidence intervals, `OR11` = $OR_{A = 1, M = 1}$ , `OR10` = $OR_{A = 1}$, `OR01` = $OR_{M = 1}$ and `OR00` captures the reference.\n\n\n::: {#tbl-effint .cell tbl-cap='Summary report from an interaction analysis when investigating association between two exposure variables (smoking and income) and hypertension.' hash='chapter_07_cache/html/tbl-effint_672a8d9c3939dc253504aabbcf97d061'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Measures </th>\n   <th style=\"text-align:right;\"> Estimates </th>\n   <th style=\"text-align:right;\"> CI.ll </th>\n   <th style=\"text-align:right;\"> CI.ul </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> OR00 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR01 </td>\n   <td style=\"text-align:right;\"> 1.09 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n   <td style=\"text-align:right;\"> 1.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR10 </td>\n   <td style=\"text-align:right;\"> 3.35 </td>\n   <td style=\"text-align:right;\"> 2.95 </td>\n   <td style=\"text-align:right;\"> 3.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR11 </td>\n   <td style=\"text-align:right;\"> 4.02 </td>\n   <td style=\"text-align:right;\"> 3.29 </td>\n   <td style=\"text-align:right;\"> 4.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR(income0 on outcome [smoking1==0] </td>\n   <td style=\"text-align:right;\"> 1.09 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n   <td style=\"text-align:right;\"> 1.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR(income0 on outcome [smoking1==1] </td>\n   <td style=\"text-align:right;\"> 1.20 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 1.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR(smoking1 on outcome [income0==0] </td>\n   <td style=\"text-align:right;\"> 3.35 </td>\n   <td style=\"text-align:right;\"> 2.95 </td>\n   <td style=\"text-align:right;\"> 3.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR(smoking1 on outcome [income0==1] </td>\n   <td style=\"text-align:right;\"> 3.69 </td>\n   <td style=\"text-align:right;\"> 3.11 </td>\n   <td style=\"text-align:right;\"> 4.37 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Multiplicative scale </td>\n   <td style=\"text-align:right;\"> 1.10 </td>\n   <td style=\"text-align:right;\"> 0.90 </td>\n   <td style=\"text-align:right;\"> 1.35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> RERI </td>\n   <td style=\"text-align:right;\"> 0.59 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 1.27 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AP </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.26 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SI </td>\n   <td style=\"text-align:right;\"> 1.24 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n   <td style=\"text-align:right;\"> 1.53 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-15_fa51791c0e0ffccf88a7d8ca06b1f52a'}\n\n```{.r .cell-code}\n# test run with additive model\nObs.Data$smoking <- as.numeric(as.character(Obs.Data$smoking))\nObs.Data$income <- as.numeric(as.character(Obs.Data$income))\nfit.w.int.add <- glm(hypertension ~ smoking * income + age + gender + education, \n            family=gaussian(link = \"identity\"), data=Obs.Data)\nsim_slopes(fit.w.int.add, pred = smoking, modx = income,\n           exp = TRUE, robust = TRUE,\n           confint = TRUE, data = Obs.Dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nJOHNSON-NEYMAN INTERVAL \n\nWhen income is INSIDE the interval [-3.27, 16.87], the slope of smoking is\np < .05.\n\nNote: The range of observed values of income is [0.00, 1.00]\n\nSIMPLE SLOPES ANALYSIS \n\nSlope of smoking when income = 0.00 (0): \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  0.25   0.02   1.24    1.34    12.76   0.00\n\nSlope of smoking when income = 1.00 (1): \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  0.28   0.01   1.30    1.34    34.53   0.00\n```\n:::\n:::\n\n\n\n## Step-by-Step Guideline for Practitioners regarding Implementation\n\n### Propensity score matching approaches\n\n#### Stratified approach with exact matching within subgroups {.unnumbered}\n\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-16_c26f42f0e5b4f98b1338d9f2e8e95bb3'}\n\n```{.r .cell-code}\n# For income = 0\nrequire(MatchIt)\nset.seed(123)\nObs.Data <- sim(DAG = Dset, n = 5000, rndseed = 123)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nsimulating observed dataset from the DAG object\n```\n:::\n\n```{.r .cell-code}\nmatch.income.0 <- matchit(smoking ~ age + gender, \n                            data = subset(Obs.Data, income == 0),\n                      method = \"full\", distance = \"glm\", link = \"logit\")\ndata.income.0 <- match.data(match.income.0)\n```\n:::\n\n\nBelow, we draw a sample from the high-income group based on the hypothetical example of an association between hypertension and smoking. Here age [centered], gender, education, and diet are covariates.\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-17_f47ecc6bf8f5f9c5d6c0838a638a4e73'}\n::: {.cell-output .cell-output-stdout}\n```\n            age gender education diet income smoking hypertension  distance\n657   6.0810120      0         1    1      0       1            1 0.9999874\n4932  1.6109860      1         1    0      0       1            0 0.9943155\n252  -0.2475055      1         1    1      0       0            1 0.8525107\n2693 -0.2511048      1         1    0      0       1            1 0.8516785\n1646 -0.2836155      1         0    1      0       1            1 0.8439843\n        weights subclass\n657  1.00000000       13\n4932 1.00000000       37\n252  0.01648045        9\n2693 1.00000000        9\n1646 1.00000000       42\n```\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-18_d05603d6f33f996bc3dff51269dcaca5'}\n\n```{.r .cell-code}\n# For income = 1\nmatch.income.1 <- matchit(smoking ~ age + gender, \n                          data = subset(Obs.Data, income == 1),\n                       method = \"full\", distance = \"glm\", link = \"logit\")\ndata.income.1 <- match.data(match.income.1)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-19_8e74a4af7e427e84f6d36ef900311bb0'}\n\n```{.r .cell-code}\n# Treatment effect estimation\nfit.income.0 <- glm(hypertension ~ smoking + age + gender, \n                   data = data.income.0, weights = weights,\n                   family = binomial(\"logit\"))\nfit.income.1 <- glm(hypertension ~ smoking + age + gender, \n                   data = data.income.1, weights = weights,\n                   family = binomial(\"logit\"))\n# Robust variance calculation\nrequire(jtools)\nfit.nexp.adj.res1 <- summ(fit.income.1,  \n                          robust = TRUE,\n                          cluster = \"subclass\",\n                          model.info = FALSE, \n                          model.fit = FALSE, \n                          confint = TRUE)\nfit.nexp.adj.res0 <- summ(fit.income.0, \n                          robust = TRUE,\n                          cluster = \"subclass\",\n                          model.info = FALSE, \n                          model.fit = FALSE, \n                          confint = TRUE)\n```\n:::\n\n::: {#tbl-stratified-approach .cell tbl-cap='Subgroup-specific treatment effect estimates (expressed in log-OR) from the hypothetical example using the stratified approach.' hash='chapter_07_cache/html/tbl-stratified-approach_9979cc5ea0b1f49969f427af3cf4ea56'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Value of income </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> z val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3.66 </td>\n   <td style=\"text-align:right;\"> -43.26 </td>\n   <td style=\"text-align:right;\"> 50.58 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.34 </td>\n   <td style=\"text-align:right;\"> 0.89 </td>\n   <td style=\"text-align:right;\"> 1.78 </td>\n   <td style=\"text-align:right;\"> 5.91 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n#### Joint approach without exact matching within subgroups {.unnumbered}\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-21_ed70b624117d25cfda90bc79aa2aa0ff'}\n\n```{.r .cell-code}\nps.formula <- as.formula(\"smoking ~ age + gender + income\")\nmatch.obj.j <- matchit(ps.formula, data = Obs.Data,\n                      method = \"full\", \n                      distance = \"glm\",\n                      link = \"logit\")\nmatch.data.j <- match.data(match.obj.j)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-22_e8251db008ec8b7d4e7ff559894d0943'}\n\n```{.r .cell-code}\nfit.joint.no.exact <- glm(hypertension ~ smoking*income + age + gender, \n              data = match.data.j, weights = weights,\n              family = binomial(\"logit\"))\nrequire(interactions)\nnem.nexp.adj.res <- sim_slopes(fit.joint.no.exact, \n                               pred = smoking, modx = income,\n                               robust = \"HC1\", cluster = \"subclass\",\n                               johnson_neyman = TRUE, confint = TRUE,\n                               data = match.data.j)\n```\n:::\n\n::: {#tbl-joint-approach .cell tbl-cap='Subgroup-specific treatment effect estimates (expressed in log-OR) from the hypothetical example using the joint approach.' hash='chapter_07_cache/html/tbl-joint-approach_6da6be7a2a8448b6c1e2ae7bed7cea62'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Value of income </th>\n   <th style=\"text-align:right;\"> Est. </th>\n   <th style=\"text-align:right;\"> S.E. </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> z val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3.77 </td>\n   <td style=\"text-align:right;\"> 1.02 </td>\n   <td style=\"text-align:right;\"> 1.76 </td>\n   <td style=\"text-align:right;\"> 5.77 </td>\n   <td style=\"text-align:right;\"> 3.68 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.31 </td>\n   <td style=\"text-align:right;\"> 0.28 </td>\n   <td style=\"text-align:right;\"> 0.76 </td>\n   <td style=\"text-align:right;\"> 1.86 </td>\n   <td style=\"text-align:right;\"> 4.69 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}