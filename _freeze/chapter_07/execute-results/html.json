{
  "hash": "ef8f9b1b5094de3d62076848327c3bd7",
  "result": {
    "markdown": "---\ntitle: \"Effect Modification Analysis within the Propensity score Framework\"\nauthor: \"Mohammad Ehsanul Karim\"\nformat:\n  html:\n    toc: true\n    number-sections: true\neditor: visual\nexecute:\n  cache: true\n---\n\n\n\n\n# Simulation\n\nFirst, we need to install the R package `simcausal`, which can be obtained from GitHub:\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-2_4e6f515dd57a5656dc90caf5bab54e67'}\n\n```{.r .cell-code}\ndevtools::install_github('osofr/simcausal', build_vignettes = FALSE)\n```\n:::\n\n\nWe will use the following data-generation model:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-3_3ce556834b402725aeb1d9fdd5044354'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"age\", distr = \"rnorm\", \n       mean = 2, sd = 4) + \n  node(\"gender\", distr = \"rbern\", \n       prob = plogis(4)) +\n  node(\"education\", distr = \"rbern\", \n       prob = plogis(3 + 5* age)) +\n  node(\"diet\", distr = \"rbern\", \n       prob = plogis(1 -3 * education)) +\n  node(\"income\", distr = \"rbern\", \n       prob = plogis(2 - 5 * education - 4 * age)) +\n  node(\"smoking\", distr = \"rbern\", \n       prob = plogis(1 + 1.2 * gender + 2 * age)) +\n  node(\"hypertension\", distr = \"rbern\", \n       prob = plogis(1 + log(3) * diet + \n                       log(1.3) * age + \n                       log(3.5) * smoking + \n                       log(0.5) * gender))\nDset <- set.DAG(D)\nplotDAG(Dset)\n```\n\n::: {.cell-output-display}\n![](chapter_07_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nWe can now generate an example dataset:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-4_7ba6e48bb976f445f2f565e1c642d065'}\n\n```{.r .cell-code}\nObs.Data <- sim(DAG = Dset, n = 50000, rndseed = 123)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nsimulating observed dataset from the DAG object\n```\n:::\n:::\n\n\n\n# Effect measure assessment via adding interaction term\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-5_537ceeaa1f435c973e2be87221cb1c2a'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\n\\caption{\\label{tab:unnamed-chunk-5}Sample data from the hypothetical example of association between hypertension and  smoking, where other variables such as income, age [centered], gender, education and diet also plays a role in the data generation process.\\label{tab:sampledata}}\n\\centering\n\\begin{tabular}[t]{rrrrrrr}\n\\toprule\nage & gender & education & diet & income & smoking & hypertension\\\\\n\\midrule\n12.29 & 1 & 1 & 1 & 0 & 1 & 1\\\\\n10.40 & 1 & 1 & 0 & 0 & 1 & 1\\\\\n2.99 & 1 & 1 & 0 & 0 & 1 & 0\\\\\n-4.31 & 0 & 0 & 0 & 1 & 0 & 1\\\\\n-6.44 & 0 & 0 & 0 & 1 & 0 & 1\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-6_01a7eb004266ffa651442b6dce18d9f1'}\n\n```{.r .cell-code}\nObs.Data$smoking <- as.character(Obs.Data$smoking)\nObs.Data$income <- as.factor(Obs.Data$income)\nObs.Data$income <- relevel(Obs.Data$income, ref = \"1\")\nfit.w.em <- glm(hypertension ~ smoking * income + age + gender, \n            family = binomial(link = \"logit\"), data = Obs.Data)\n\nrequire(jtools)\nresults.model <- summ(fit.w.em, model.info = FALSE, \n                      model.fit = FALSE,\n                      exp = TRUE)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-7_507d11992f8452695351e70f59a2bfe1'}\n::: {.cell-output-display}\n\\begin{table}\n\n\\caption{\\label{tab:unnamed-chunk-7}Assessment of effect modification by income. The output shown from the logistic regression model in a odds ratio scale, where hypertnsion is the outcome, smoking is the exposure, age, gender are confounders, and main effect and interaction term of income and exposure are added. Here the interaction term is significant.\\label{tab:effmod0}}\n\\centering\n\\begin{tabular}[t]{lrrrrr}\n\\toprule\n  & exp(Est.) & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n(Intercept) & 5.46 & 4.37 & 6.82 & 14.97 & 0.00\\\\\nsmoking1 & 2.93 & 2.60 & 3.30 & 17.69 & 0.00\\\\\nincome0 & 0.48 & 0.41 & 0.57 & -8.28 & 0.00\\\\\nage & 1.29 & 1.27 & 1.31 & 36.77 & 0.00\\\\\ngender & 0.54 & 0.43 & 0.67 & -5.55 & 0.00\\\\\n\\addlinespace\nsmoking1:income0 & 1.27 & 1.04 & 1.56 & 2.33 & 0.02\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n\n\n## Presentation of effect measures {.unnumbered}\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-9_5e9cc81ac9b684bed1d60250d0455512'}\n\n```{.r .cell-code}\nrequire(interactionR)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: interactionR\n```\n:::\n\n```{.r .cell-code}\nem.object = interactionR(fit.w.em, \n                            exposure_names = c(\"income0\", \"smoking1\"), \n                            ci.type = \"mover\", ci.level = 0.95, \n                            em=TRUE, recode = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in interactionR(fit.w.em, exposure_names = c(\"income0\", \"smoking1\"), :\nAt least one exposure is preventive. Set argument recode=TRUE for the exposures\nto be automatically recoded. see Knol et al. (2011) European Journal of\nEpidemiology, 26(6), 433-438\n```\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-10_c1280f945d2cf456231d54716b4cb072'}\n::: {.cell-output-display}\n\\begin{table}\n\n\\caption{\\label{tab:unnamed-chunk-10}Summary report from an effect modification analysis by income when investigating association between one exposure variable (smoking) and outcome hypertension. Adjusted odds ratios are reported for income levels (`high' = 0, and `low' = 1).\\label{tab:effmod}}\n\\centering\n\\begin{tabular}[t]{lrrrr}\n\\toprule\nMeasures & Estimates & CI.ll & CI.ul & p\\\\\n\\midrule\nOR(smoking1 on outcome [income0==0] & 2.93 & 2.60 & 3.30 & 0.00\\\\\nOR(smoking1 on outcome [income0==1] & 3.72 & 3.14 & 4.41 & 0.00\\\\\nMultiplicative scale & 1.27 & 1.04 & 1.56 & 0.02\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}