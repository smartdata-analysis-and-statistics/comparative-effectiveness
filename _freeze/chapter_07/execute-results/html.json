{
  "hash": "3cd8d082babb149651f6fb111fd73b0f",
  "result": {
    "markdown": "---\ntitle: \"Effect Modification Analysis within the Propensity score Framework\"\nauthor: \"Mohammad Ehsanul Karim\"\nformat:\n  html:\n    toc: true\n    number-sections: true\neditor: visual\nexecute:\n  cache: true\n---\n\n\n\n\n## Simulation\n\nFirst, we need to install the R package `simcausal`, which can be obtained from GitHub:\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-2_4e6f515dd57a5656dc90caf5bab54e67'}\n\n```{.r .cell-code}\ndevtools::install_github('osofr/simcausal', build_vignettes = FALSE)\n```\n:::\n\n\nWe will use the following data-generation model:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-3_3ce556834b402725aeb1d9fdd5044354'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"age\", distr = \"rnorm\", \n       mean = 2, sd = 4) + \n  node(\"gender\", distr = \"rbern\", \n       prob = plogis(4)) +\n  node(\"education\", distr = \"rbern\", \n       prob = plogis(3 + 5* age)) +\n  node(\"diet\", distr = \"rbern\", \n       prob = plogis(1 -3 * education)) +\n  node(\"income\", distr = \"rbern\", \n       prob = plogis(2 - 5 * education - 4 * age)) +\n  node(\"smoking\", distr = \"rbern\", \n       prob = plogis(1 + 1.2 * gender + 2 * age)) +\n  node(\"hypertension\", distr = \"rbern\", \n       prob = plogis(1 + log(3) * diet + \n                       log(1.3) * age + \n                       log(3.5) * smoking + \n                       log(0.5) * gender))\nDset <- set.DAG(D)\nplotDAG(Dset)\n```\n\n::: {.cell-output-display}\n![](chapter_07_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nWe can now generate an example dataset:\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-4_da55e9eb41d6801a35e512155aa51222'}\n\n```{.r .cell-code}\nObs.Data <- sim(DAG = Dset, n = 50000, rndseed = 123)\n```\n:::\n\n\n\n## Effect measure assessment via adding interaction term\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-5_537ceeaa1f435c973e2be87221cb1c2a'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\n\\caption{\\label{tab:unnamed-chunk-5}Sample data from the hypothetical example of association between hypertension and  smoking, where other variables such as income, age [centered], gender, education and diet also plays a role in the data generation process.\\label{tab:sampledata}}\n\\centering\n\\begin{tabular}[t]{rrrrrrr}\n\\toprule\nage & gender & education & diet & income & smoking & hypertension\\\\\n\\midrule\n12.29 & 1 & 1 & 1 & 0 & 1 & 1\\\\\n10.40 & 1 & 1 & 0 & 0 & 1 & 1\\\\\n2.99 & 1 & 1 & 0 & 0 & 1 & 0\\\\\n-4.31 & 0 & 0 & 0 & 1 & 0 & 1\\\\\n-6.44 & 0 & 0 & 0 & 1 & 0 & 1\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\nBelow, we estimate a logistic regression model to assess whether the effect of smoking (the exposure) on hypertension is modified by income. The covariates age and gender are confounders.\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-6_fc4a2cb429c46178615345bb05b2875f'}\n\n```{.r .cell-code}\nObs.Data$smoking <- as.character(Obs.Data$smoking)\nObs.Data$income <- as.factor(Obs.Data$income)\nObs.Data$income <- relevel(Obs.Data$income, ref = \"1\")\nfit.w.em <- glm(hypertension ~ smoking * income + age + gender, \n            family = binomial(link = \"logit\"), data = Obs.Data)\n\nrequire(jtools)\nresults.model <- summ(fit.w.em, model.info = FALSE, \n                      model.fit = FALSE,\n                      exp = TRUE)\nresults.model\n```\n\n::: {.cell-output-display}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> exp(Est.) </th>\n   <th style=\"text-align:right;\"> 2.5% </th>\n   <th style=\"text-align:right;\"> 97.5% </th>\n   <th style=\"text-align:right;\"> z val. </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 5.46 </td>\n   <td style=\"text-align:right;\"> 4.37 </td>\n   <td style=\"text-align:right;\"> 6.82 </td>\n   <td style=\"text-align:right;\"> 14.97 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> smoking1 </td>\n   <td style=\"text-align:right;\"> 2.93 </td>\n   <td style=\"text-align:right;\"> 2.60 </td>\n   <td style=\"text-align:right;\"> 3.30 </td>\n   <td style=\"text-align:right;\"> 17.69 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> income0 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n   <td style=\"text-align:right;\"> 0.41 </td>\n   <td style=\"text-align:right;\"> 0.57 </td>\n   <td style=\"text-align:right;\"> -8.28 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> age </td>\n   <td style=\"text-align:right;\"> 1.29 </td>\n   <td style=\"text-align:right;\"> 1.27 </td>\n   <td style=\"text-align:right;\"> 1.31 </td>\n   <td style=\"text-align:right;\"> 36.77 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> gender </td>\n   <td style=\"text-align:right;\"> 0.54 </td>\n   <td style=\"text-align:right;\"> 0.43 </td>\n   <td style=\"text-align:right;\"> 0.67 </td>\n   <td style=\"text-align:right;\"> -5.55 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> smoking1:income0 </td>\n   <td style=\"text-align:right;\"> 1.27 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n   <td style=\"text-align:right;\"> 1.56 </td>\n   <td style=\"text-align:right;\"> 2.33 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Standard errors: MLE</td></tr></tfoot>\n</table>\n:::\n:::\n\n\nThe interaction term in `results.model` is significant.\n\n\n### Presentation of effect measures {.unnumbered}\n\n\n::: {.cell hash='chapter_07_cache/html/unnamed-chunk-7_f10d879f039be4550907cf2540fc3062'}\n\n```{.r .cell-code}\nrequire(interactionR)\nem.object <- interactionR(fit.w.em, \n                          exposure_names = c(\"income0\", \"smoking1\"), \n                          ci.type = \"mover\", ci.level = 0.95, \n                          em = TRUE, recode = FALSE)\n```\n:::\n\n::: {.cell tbl-cap='Summary report from an effect modification analysis by income when investigating association between one exposure variable (smoking) and outcome hypertension. Adjusted odds ratios are reported for income levels (`high\\' = 0, and `low\\' = 1)' hash='chapter_07_cache/html/tab-effmod_238b5b3431745949b7d1562786b58615'}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Measures </th>\n   <th style=\"text-align:right;\"> Estimates </th>\n   <th style=\"text-align:right;\"> CI.ll </th>\n   <th style=\"text-align:right;\"> CI.ul </th>\n   <th style=\"text-align:right;\"> p </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> OR(smoking1 on outcome [income0==0] </td>\n   <td style=\"text-align:right;\"> 2.93 </td>\n   <td style=\"text-align:right;\"> 2.60 </td>\n   <td style=\"text-align:right;\"> 3.30 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> OR(smoking1 on outcome [income0==1] </td>\n   <td style=\"text-align:right;\"> 3.72 </td>\n   <td style=\"text-align:right;\"> 3.14 </td>\n   <td style=\"text-align:right;\"> 4.41 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Multiplicative scale </td>\n   <td style=\"text-align:right;\"> 1.27 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n   <td style=\"text-align:right;\"> 1.56 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}