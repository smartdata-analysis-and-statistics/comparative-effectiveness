{
  "hash": "9d8e208e3c5781f08cecf1e3f4f144a0",
  "result": {
    "markdown": "---\ntitle: \"Effect Modification Analysis within the Propensity score Framework\"\nauthors:   \n  - name: Mohammad Ehsanul Karim\n    orcid: 0000-0002-0346-2871\n    affiliations:\n      - ref: bcolumbia\naffiliations:\n  - id: smartdas\n    name: Smart Data Analysis and Statistics B.V.\n    city: Utrecht\n  - id: bcolumbia\n    name: University of British Columbia\n    city: Vancouver, BC, Canada\nformat:\n  html:\n    toc: true\n    number-sections: true\nexecute:\n  cache: true\n---\n\n\n\n\n\nObservational comparative effectiveness studies often adopt propensity score analysis to adjust for confounding. Although this approach is relatively straightforward to implement, careful thought is needed when treatment effect heterogeneity is present. This chapter illustrates the estimation of subgroup-specific treatment effects using (traditional) covariate adjustment methods, propensity score matching, propensity score weighting, propensity score stratification, and covariate adjustment using propensity scores. \n\n\n## Simulation\n\nFirst, we need to install the R package `simcausal`, which can be obtained from GitHub:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-2_958dcfc98e6d05db1895158afa1b0f65'}\n\n```{.r .cell-code}\ndevtools::install_github('osofr/simcausal', build_vignettes = FALSE)\n```\n:::\n\n\n\nWe will use the following data-generation model:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-3_c2312cfd0fbc646985c333135462bc5b'}\n\n```{.r .cell-code}\nrequire(simcausal)\nD <- DAG.empty()\nD <- D + \n  node(\"age\", distr = \"rnorm\", \n       mean = 2, sd = 4) + \n  node(\"gender\", distr = \"rbern\", \n       prob = plogis(4)) +\n  node(\"education\", distr = \"rbern\", \n       prob = plogis(3 + 5 * age)) +\n  node(\"diet\", distr = \"rbern\", \n       prob = plogis(1 - 3 * education)) +\n  node(\"income\", distr = \"rbern\", \n       prob = plogis(2 - 5 * education - 4 * age)) +\n  node(\"smoking\", distr = \"rbern\", \n       prob = plogis(1 + 1.2 * gender + 2 * age)) +\n  node(\"hypertension\", distr = \"rbern\", \n       prob = plogis(1 + log(3) * diet + \n                       log(1.3) * age + \n                       log(3.5) * smoking + \n                       log(0.5) * gender))\nDset <- set.DAG(D)\n```\n:::\n\n\n\nBelow is the diagram, with pink lines representing open backdoor path.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-4_3a4b57a9bf8d2358930f69adf6338151'}\n::: {.cell-output .cell-output-stderr}\n```\nusing the following vertex attributes: \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nNAdarkbluenone100.50\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nusing the following edge attributes: \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nblack0.210.60.5\n```\n:::\n\n::: {.cell-output-display}\n![](chapter_07_files/figure-pdf/unnamed-chunk-4-1.pdf)\n:::\n:::\n\n\n\nWe can now generate an example dataset:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-5_fdaf90ee6e423e2a6cd7ce85dcd1e664'}\n\n```{.r .cell-code}\nObs.Data <- sim(DAG = Dset, n = 50000, rndseed = 123)\nObs.Data$smoking <- as.character(Obs.Data$smoking)\nObs.Data$income <- as.factor(Obs.Data$income)\nObs.Data$income <- relevel(Obs.Data$income, ref = \"1\")\n```\n:::\n\n\n\nSample data from the hypothetical example of association between hypertension and smoking, where other variables such as income, age \\[centered\\], gender, education and diet also plays a role in the data generation process.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-6_235dc6a55d2db44d5877f9db7b1cc0a0'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lrrrrllr}\n\\toprule\n  & age & gender & education & diet & income & smoking & hypertension\\\\\n\\midrule\n34901 & 12.29 & 1 & 1 & 1 & 0 & 1 & 1\\\\\n149 & 10.40 & 1 & 1 & 0 & 0 & 1 & 1\\\\\n10060 & 2.99 & 1 & 1 & 0 & 0 & 1 & 0\\\\\n22220 & -4.31 & 0 & 0 & 0 & 1 & 0 & 1\\\\\n9979 & -6.44 & 0 & 0 & 0 & 1 & 0 & 1\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n##  Covariate adjustment\n\n### Interaction approach\n\nBelow, we estimate a logistic regression model to assess whether the effect of smoking (the exposure) on hypertension is modified by income levels. This model considers the following variables: \n\n-   Outcome: `hypertension`\n-   Exposure variables: `smoking` and `income`\n-   Confounders: `age` and `gender`\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-7_a423ce59f76275b917a532b0f9afc065'}\n\n```{.r .cell-code}\nrequire(jtools)\n\nfit.w.em <- glm(hypertension ~ smoking * income + age + gender, \n            family = binomial(link = \"logit\"), data = Obs.Data)\n\nresults.model <- summ(fit.w.em, exp = TRUE)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-8_7a8d86fa119dd450d187509140001662'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lrrrrr}\n\\toprule\n  & exp(Est.) & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n(Intercept) & 5.46 & 4.37 & 6.82 & 14.97 & 0.00\\\\\nsmoking1 & 2.93 & 2.60 & 3.30 & 17.69 & 0.00\\\\\nincome0 & 0.48 & 0.41 & 0.57 & -8.28 & 0.00\\\\\nage & 1.29 & 1.27 & 1.31 & 36.77 & 0.00\\\\\ngender & 0.54 & 0.43 & 0.67 & -5.55 & 0.00\\\\\n\\addlinespace\nsmoking1:income0 & 1.27 & 1.04 & 1.56 & 2.33 & 0.02\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nResults indicate that the interaction between smoking status and income level is statistically significant (p = 0.02).\n\nIf we expand previous model to adjust for an additional confounder `education`, we have: \n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-9_ab26a16350aef5e77d3c3db0447c030f'}\n\n```{.r .cell-code}\nfit.w.int <- glm(hypertension ~ smoking * income + age + gender + education, \n                 family = binomial(link = \"logit\"), \n                 data = Obs.Data)\n\nresults.int.model <- summ(fit.w.int, exp = TRUE)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-10_f4fb8e4c5c06e18f2eba92b011025cb5'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lrrrrr}\n\\toprule\n  & exp(Est.) & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n(Intercept) & 5.69 & 4.56 & 7.11 & 15.31 & 0.00\\\\\nsmoking1 & 3.35 & 2.95 & 3.79 & 18.85 & 0.00\\\\\nincome0 & 1.09 & 0.85 & 1.40 & 0.68 & 0.49\\\\\nage & 1.30 & 1.28 & 1.32 & 37.32 & 0.00\\\\\ngender & 0.54 & 0.43 & 0.67 & -5.58 & 0.00\\\\\n\\addlinespace\neducation & 0.42 & 0.35 & 0.51 & -8.87 & 0.00\\\\\nsmoking1:income0 & 1.10 & 0.90 & 1.35 & 0.93 & 0.35\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nThe interaction term between income and smoking is no longer statistically significant  (p = 0.35).\n\nWe can generate a summary report from aforementioned effect modification analysis. \n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-11_cf87d01dd7f09f78ed2c34f7e577cfc5'}\n\n```{.r .cell-code}\nrequire(interactionR)\n\nem.object <- interactionR(fit.w.em, \n                          exposure_names = c(\"income0\", \"smoking1\"), \n                          ci.type = \"mover\", ci.level = 0.95, \n                          em = TRUE, recode = FALSE)\n```\n:::\n\n\n\nThe table below depicts the adjusted odds ratios for income levels (`high = 0`, and `low = 1`). The variables `CI.ll` and `CI.ul` depict the lower and upper limits of the 95 percent confidence intervals, `OR11` = $OR_{A = 1, M = 1}$ , `OR10` = $OR_{A = 1}$, `OR01` = $OR_{M = 1}$ and `OR00` captures the reference.\n\n\n\n::: {#tbl-effint-fit.w.em .cell tbl-cap='Summary report from an interaction analysis when investigating association between two exposure variables (smoking and income) and hypertension.' hash='chapter_07_cache/pdf/tbl-effint-fit.w.em_c39c7360ee616a5913c0220cf053e93a'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lrrr}\n\\toprule\nMeasures & Estimates & CI.ll & CI.ul\\\\\n\\midrule\nOR00 & 1.00 & NA & NA\\\\\nOR01 & 2.93 & 2.60 & 3.30\\\\\nOR10 & 0.48 & 0.41 & 0.57\\\\\nOR11 & 1.80 & 1.63 & 1.98\\\\\nOR(smoking1 on outcome [income0==0] & 2.93 & 2.60 & 3.30\\\\\n\\addlinespace\nOR(smoking1 on outcome [income0==1] & 3.72 & 3.14 & 4.41\\\\\nMultiplicative scale & 1.27 & 1.04 & 1.56\\\\\nRERI & -0.61 & -0.98 & -0.29\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nSimilarly, for the analysis adjusting for an additional confounder `education`, we have:\n\n\n\n::: {#tbl-effint-fit.w.int .cell tbl-cap='Summary report from an interaction analysis when investigating association between two exposure variables (smoking and income) and hypertension.' hash='chapter_07_cache/pdf/tbl-effint-fit.w.int_31b64e76803347bc9d00ba92e16cf42f'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lrrr}\n\\toprule\nMeasures & Estimates & CI.ll & CI.ul\\\\\n\\midrule\nOR00 & 1.00 & NA & NA\\\\\nOR01 & 1.09 & 0.85 & 1.40\\\\\nOR10 & 3.35 & 2.95 & 3.79\\\\\nOR11 & 4.02 & 3.29 & 4.92\\\\\nOR(income0 on outcome [smoking1==0] & 1.09 & 0.85 & 1.40\\\\\n\\addlinespace\nOR(income0 on outcome [smoking1==1] & 1.20 & 1.00 & 1.45\\\\\nOR(smoking1 on outcome [income0==0] & 3.35 & 2.95 & 3.79\\\\\nOR(smoking1 on outcome [income0==1] & 3.69 & 3.11 & 4.37\\\\\nMultiplicative scale & 1.10 & 0.90 & 1.35\\\\\nRERI & 0.59 & 0.03 & 1.27\\\\\n\\addlinespace\nAP & 0.15 & 0.00 & 0.26\\\\\nSI & 1.24 & 1.01 & 1.53\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-14_8d2c512b0280e86368b717ba60cd844a'}\n\n```{.r .cell-code}\n# test run with additive model\nObs.Data$smoking <- as.numeric(as.character(Obs.Data$smoking))\nObs.Data$income <- as.numeric(as.character(Obs.Data$income))\nfit.w.int.add <- glm(hypertension ~ smoking * income + age + gender + education, \n                     family = gaussian(link = \"identity\"), data = Obs.Data)\nsim_slopes(fit.w.int.add, pred = smoking, modx = income,\n           exp = TRUE, robust = TRUE,\n           confint = TRUE, data = Obs.Dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nJOHNSON-NEYMAN INTERVAL \n\nWhen income is INSIDE the interval [-3.27, 16.87], the slope of smoking is\np < .05.\n\nNote: The range of observed values of income is [0.00, 1.00]\n\nSIMPLE SLOPES ANALYSIS \n\nSlope of smoking when income = 0.00 (0): \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  0.25   0.02   1.24    1.34    12.76   0.00\n\nSlope of smoking when income = 1.00 (1): \n\n  Est.   S.E.   2.5%   97.5%   t val.      p\n------ ------ ------ ------- -------- ------\n  0.28   0.01   1.30    1.34    34.53   0.00\n```\n:::\n:::\n\n\n\n\n### Stratification\n\nThis approach involves estimating a regression model in different strata of the discrete effect modifier `income`:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-15_5176995fced1afdf9dde0a52d8ac13eb'}\n\n```{.r .cell-code}\n# Estimate the prognostic effect of smoking in low income individuals\nfit.income1 <- glm(hypertension ~ smoking + age + gender, \n            family = binomial(link = \"logit\"), \n            data = subset(Obs.Data, income == 1))\n\n# Estimate the prognostic effect of smoking in high income individuals\nfit.income0 <- glm(hypertension ~ smoking + age + gender, \n            family = binomial(link = \"logit\"), \n            data = subset(Obs.Data, income == 0))\n```\n:::\n\n\n\nThe table below summarizes the adjusted odds ratios for smoking across the different income levels (`low = 1`, and `high = 0`) as obtained using the stratified approach.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-16_fdb4e68cc10c4da8ccd2ef1eba42f991'}\n\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-17_a10791d3187b4fddf9ef737c669742a2'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrr}\n\\toprule\nValue of income & Estimate & 2.5 \\% & 97.5 \\% & z value & p value\\\\\n\\midrule\n1 & 3.07 & 2.71 & 3.47 & 17.65 & 0\\\\\n0 & 3.59 & 3.02 & 4.26 & 14.57 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nNote that we can obtain the same results by estimating a regression model with an interaction term between the modifier and all covariates:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-18_a962e4944cb9e60f43f7cc5bcc5cf3a1'}\n\n```{.r .cell-code}\nfit.all.int <- glm(hypertension ~ income * (smoking + age + gender), \n                   family = binomial(link = \"logit\"), data = Obs.Data)\n\n# Odds ratio for smoking in individuals with low income \nexp(coef(fit.all.int)[\"smoking\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nsmoking \n3.59026 \n```\n:::\n\n```{.r .cell-code}\n# Odds ratio for smoking in individuals with high income\nexp(coef(fit.all.int)[\"smoking\"] + coef(fit.all.int)[\"income:smoking\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n smoking \n3.066878 \n```\n:::\n:::\n\n\n\n\n## Propensity score matching\n\n### Stratification with exact matching within subgroups\n\nWe simulate another example dataset using aforementioned DAG, but restrict the sample size to 5000 individuals to reduce computational burden. \n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-19_8d669d2b89a04eb6b217ed91ff8eac78'}\n\n```{.r .cell-code}\nset.seed(123)\nObs.Data <- sim(DAG = Dset, n = 5000, rndseed = 123)\n```\n:::\n\n\n\nWe first estimate the propensity of smoking in the high-income group (`income == 0`):\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-20_593b6ba8bfe777486aa37e19ae8b4ffb'}\n\n```{.r .cell-code}\nrequire(MatchIt)\n\nmatch.income.0 <- matchit(smoking ~ age + gender, \n                          data = subset(Obs.Data, income == 0),\n                          method = \"full\", distance = \"glm\", link = \"logit\")\ndata.income.0 <- match.data(match.income.0)\n```\n:::\n\n\n\nBelow, we draw a sample from the high-income group based on the hypothetical example of an association between hypertension and smoking. Here age \\[centered\\], gender, education, and diet are covariates.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-21_8ad31fbc8ae92c82c80d2d723adde90e'}\n::: {.cell-output .cell-output-stdout}\n```\n            age gender education diet income smoking hypertension  distance\n657   6.0810120      0         1    1      0       1            1 0.9999874\n4932  1.6109860      1         1    0      0       1            0 0.9943155\n252  -0.2475055      1         1    1      0       0            1 0.8525107\n2693 -0.2511048      1         1    0      0       1            1 0.8516785\n1646 -0.2836155      1         0    1      0       1            1 0.8439843\n        weights subclass\n657  1.00000000       36\n4932 1.00000000       50\n252  0.03296089       25\n2693 1.00000000       25\n1646 1.00000000        4\n```\n:::\n:::\n\n\n\nNow, we do the same for the low-income group (`income == 1`):\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-22_9b3c5f933298b68102b5c0fe4359a45a'}\n\n```{.r .cell-code}\nmatch.income.1 <- matchit(smoking ~ age + gender, \n                          data = subset(Obs.Data, income == 1),\n                          method = \"full\", distance = \"glm\", link = \"logit\")\ndata.income.1 <- match.data(match.income.1)\n```\n:::\n\n\n\nWe estimated the exposure effect from a weighted outcome model for the matched data. While the `weights` are essential for estimating the point estimate from the outcome model, the `subclass` variable assists in calculating the robust variance of the exposure effect estimate.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-23_0c44ab2a717e7817c5a38ab2586dffcf'}\n\n```{.r .cell-code}\n# Treatment effect estimation\nfit.income.0 <- glm(hypertension ~ smoking + age + gender, \n                   data = data.income.0, weights = weights,\n                   family = binomial(\"logit\"))\nfit.income.1 <- glm(hypertension ~ smoking + age + gender, \n                   data = data.income.1, weights = weights,\n                   family = binomial(\"logit\"))\n# Robust variance calculation\nfit.nexp.adj.res1 <- summ(fit.income.1,  \n                          robust = TRUE,\n                          cluster = \"subclass\",\n                          confint = TRUE)\nfit.nexp.adj.res0 <- summ(fit.income.0, \n                          robust = TRUE,\n                          cluster = \"subclass\",\n                          confint = TRUE)\n```\n:::\n\n::: {#tbl-stratified-approach .cell tbl-cap='Subgroup-specific treatment effect estimates (expressed in log-OR) from the hypothetical example using the stratified approach.' hash='chapter_07_cache/pdf/tbl-stratified-approach_e7ad8d72cb7b79d9088b1eb716248c8c'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrr}\n\\toprule\nValue of income & Est. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 3.74 & -37.58 & 45.06 & 0.18 & 0.86\\\\\n1 & 1.39 & 0.94 & 1.85 & 6.04 & 0.00\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n### Joint approach without exact matching within subgroups\n\nHere, entire cohort data is used to estimate the propensity scores, and the effect modifier `income` is considered as a covariate in the propensity score model:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-25_431033c76e15d3448a0c981fcc8d455f'}\n\n```{.r .cell-code}\nps.formula <- as.formula(\"smoking ~ age + gender + income\")\nmatch.obj.j <- matchit(ps.formula, data = Obs.Data,\n                      method = \"full\", \n                      distance = \"glm\",\n                      link = \"logit\")\nmatch.data.j <- match.data(match.obj.j)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-26_eac086e486931c35d6116a570ffec8e9'}\n\n```{.r .cell-code}\nfit.joint.no.exact <- glm(hypertension ~ smoking*income + age + gender, \n                          data = match.data.j, \n                          weights = weights,\n                          family = binomial(\"logit\"))\nrequire(interactions)\nnem.nexp.adj.res <- sim_slopes(fit.joint.no.exact, \n                               pred = smoking, \n                               modx = income,\n                               robust = \"HC1\", \n                               cluster = \"subclass\",\n                               johnson_neyman = TRUE, \n                               confint = TRUE,\n                               data = match.data.j)\n```\n:::\n\n::: {#tbl-joint-approach .cell tbl-cap='Subgroup-specific treatment effect estimates (expressed in log-OR) from the hypothetical example using the joint approach.' hash='chapter_07_cache/pdf/tbl-joint-approach_b0b8014d942f00e3d31b562993381d0b'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{r|r|r|r|r|r|r}\n\\hline\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\hline\n0 & 3.85 & 1.00 & 1.89 & 5.82 & 3.84 & 0\\\\\n\\hline\n1 & 1.40 & 0.28 & 0.85 & 1.95 & 4.99 & 0\\\\\n\\hline\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n### Joint approach with exact matching within subgroups\n\nWe specify the moderator variable's name in the `exact` argument of the `matchit` function.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-28_81a52dc7a6f354f91dbf265e0a57b103'}\n\n```{.r .cell-code}\nps.formula.no.mod <- as.formula(\"smoking ~ age + gender\")\nmatch.obj.js <- matchit(ps.formula.no.mod, data = Obs.Data,\n                        method = \"full\", distance = \"glm\",link = \"logit\",\n                        exact = \"income\")\nmatch.data.js <- match.data(match.obj.js)\nfit.joint.exact <- glm(hypertension ~ smoking*income + age + gender, \n                       data = match.data.js, weights = weights,\n                       family = binomial(\"logit\"))\njs.nexp.adj.res <- sim_slopes(fit.joint.exact, \n                              pred = smoking, modx = income,\n                              robust = \"HC1\", cluster = \"subclass\",\n                              johnson_neyman = FALSE, confint = TRUE,\n                              data = match.data.js)\n```\n:::\n\n::: {#tbl-joint-approach-sep .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using the Joint model, separate matching approach.' hash='chapter_07_cache/pdf/tbl-joint-approach-sep_0ca1539eb38e75aad8dfdefa0cc618a9'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 3.89 & 1.01 & 1.92 & 5.87 & 3.87 & 0\\\\\n1 & 1.38 & 0.28 & 0.84 & 1.93 & 4.95 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n\n### Interaction approach without exact matching within subgroups\nAnalysts incorporate relevant moderator-covariate interactions into the propensity score model that align with biological plausibility. For instance, in the case study we considered an interaction between age (a covariate) and income (a moderator), but did not include other interactions terms. \n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-30_3cb95aac3508b3569b78bcf2207de114'}\n\n```{.r .cell-code}\nps.formula.with.int <- formula(\"smoking ~ age*income + gender\")\nmatch.obj.i <- matchit(ps.formula.with.int, data = Obs.Data,\n                       method = \"full\", distance = \"glm\",link = \"logit\")\nmatch.data.i <- match.data(match.obj.i)\nfit.int.no.exact <- glm(hypertension ~ smoking*income + age + gender, \n                        data = match.data.i, weights = weights,\n                        family = binomial(\"logit\"))\ni.nexp.adj.res <- sim_slopes(fit.int.no.exact, \n                             pred = smoking, modx = income,\n                             robust = \"HC1\", cluster = \"subclass\",\n                             johnson_neyman = FALSE, confint = TRUE,\n                             data = match.data.i)\n```\n:::\n\n::: {#tbl-int-approach-sep .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using the interaction approach.' hash='chapter_07_cache/pdf/tbl-int-approach-sep_0145377707a2ca02f1cf41e52736c5e0'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 3.87 & 1.00 & 1.90 & 5.83 & 3.86 & 0\\\\\n1 & 1.39 & 0.28 & 0.84 & 1.94 & 4.95 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n\n### Interaction approach with exact matching within subgroups\nThis method bears resemblance to the interaction approach for propensity score estimation. However, when it comes to matching, researchers match within each moderator subgroup.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-32_22dec9431b92b1ab4dea290674801a26'}\n\n```{.r .cell-code}\nmatch.obj.is <- matchit(ps.formula.with.int, data = Obs.Data,\n                      method = \"full\", distance = \"glm\",link = \"logit\",\n                      exact = \"income\")\nmatch.data.is <- match.data(match.obj.is)\nfit.int.exact <- glm(hypertension ~ smoking*income + age + gender, \n                     data = match.data.is, weights = weights,\n                     family = binomial(\"logit\"))\nis.nexp.adj.res <- sim_slopes(fit.int.exact, \n                              pred = smoking, modx = income,\n                              robust = \"HC1\", cluster = \"subclass\",\n                              johnson_neyman = FALSE, confint = TRUE,\n                              data = match.data.is)\n```\n:::\n\n::: {#tbl-ints-approach-sep .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using the interaction model, separate matching approach.' hash='chapter_07_cache/pdf/tbl-ints-approach-sep_d00a9e9933453b2653a8f011989dcd46'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 3.86 & 1.00 & 1.90 & 5.83 & 3.85 & 0\\\\\n1 & 1.40 & 0.28 & 0.85 & 1.95 & 4.99 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n## Propensity Score Weighting\n\n### Common model\n\nThis approach adds confounder-moderator interactions in the common weight model.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-34_ad64f156b216e2820a3d615956003069'}\n\n```{.r .cell-code}\nrequire(WeightIt)\nW.out <- weightit(ps.formula.with.int, \n                  data = Obs.Data,\n                  method = \"ps\", \n                  estimand = \"ATT\")\nrequire(survey)\nd.w <- svydesign(~1, weights = W.out$weights, data = Obs.Data)\nfit2w <- svyglm(hypertension ~ smoking*income, design = d.w,\n                family = binomial(\"logit\"))\nw.nexp.adj.res <- sim_slopes(fit2w, pred = smoking, modx = income, \n                             confint = TRUE)\n```\n:::\n\n::: {#tbl-common-model .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using the weighting approach.' hash='chapter_07_cache/pdf/tbl-common-model_0d2e9fd4f3a240782b82ea8fba8c9d86'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & t val. & p\\\\\n\\midrule\n0 & 2.66 & 0.63 & 1.42 & 3.89 & 4.23 & 0\\\\\n1 & 1.32 & 0.25 & 0.83 & 1.82 & 5.24 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nWe can adjust previous analysis model to adopt stabilized weights for the propensity score (`stabilize = TRUE`):\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-36_e78b4540f4ed0374fe58dc71bd8414ea'}\n\n```{.r .cell-code}\nW.out.st <- weightit(ps.formula.with.int, data = Obs.Data,\n                     method = \"ps\", \n                     estimand = \"ATT\", \n                     stabilize = TRUE)\nd.sw <- svydesign(~1, weights = W.out.st$weights, data = Obs.Data)\nfit2sw <- svyglm(hypertension ~ smoking*income + age + gender, \n                  design = d.sw,\n                  family = binomial(\"logit\"))\nws.nexp.adj.res <- sim_slopes(fit2sw, \n                              pred = smoking, modx = income, \n                              confint = TRUE)\n```\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-37_59b14c357dc3fe53baf87c1a5a8eab52'}\n\n:::\n\n::: {#tbl-weight-model .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using stabilized propensity score weights.' hash='chapter_07_cache/pdf/tbl-weight-model_47a66a471f1d70a8aa275b16d14d4b9a'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & t val. & p\\\\\n\\midrule\n0 & 2.27 & 0.73 & 0.84 & 3.69 & 3.12 & 0\\\\\n1 & 1.32 & 0.25 & 0.83 & 1.82 & 5.23 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n### Separate models\n\nPropensity score weighting approach with weights estimated separately from each subgroup:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-39_d8327726adb7f1b10d5ca1541c47cd9a'}\n\n```{.r .cell-code}\nps.formula.with.no.int <- formula(\"smoking ~ age + gender\")\nW.out1 <- weightit(ps.formula.with.no.int, \n                   data = subset(Obs.Data, income == 1),\n                   method = \"ps\", \n                   estimand = \"ATT\")\ntrimmed.weight.1.percent1 <- trim(W.out1$weights, \n                                  at = 1, lower = TRUE)\n```\n:::\n\n::: {#tbl-weight-model2 .cell tbl-cap='Weight summaries before and after truncation.' hash='chapter_07_cache/pdf/tbl-weight-model2_57d75ad6a0a3ca69e8e17bb4bca50c9e'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{lrrrrrr}\n\\toprule\nWeight & Min. & 1st Qu. & Median & Mean & 3rd Qu. & Max.\\\\\n\\midrule\nRaw weights & 0 & 0.01 & 0.11 & 0.45 & 1 & 11.69\\\\\n1\\% truncated weights & 0 & 0.01 & 0.11 & 0.44 & 1 & 7.61\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-41_d52d6c00693f8d5926294d5859070a07'}\n\n```{.r .cell-code}\n# Outcome model for income = 1\nd.w1 <- svydesign(~1, weights = trimmed.weight.1.percent1, \n                  data = subset(Obs.Data, income == 1))\nfit2unadj1 <- svyglm(hypertension ~ smoking, design = d.w1,\n                     family = binomial(\"logit\"))\n\n# weight model for income = 0\nW.out0 <- weightit(ps.formula, data = subset(Obs.Data, income == 0),\n                  method = \"ps\", estimand = \"ATT\")\ntrimmed.weight.1.percent0 <- trim(W.out0$weights, at = 1, lower = TRUE)\n\n# Outcome model for income = 0\nd.w0 <- svydesign(~1, weights = trimmed.weight.1.percent0, \n                  data = subset(Obs.Data, income == 0))\nfit2unadj0 <- svyglm(hypertension ~ smoking, design = d.w0,\n                     family = binomial(\"logit\"))\n\nfit.exp.adj.res1 <- summ(fit2unadj1, confint = TRUE)\nfit.exp.adj.res0 <- summ(fit2unadj0, confint = TRUE)\n```\n:::\n\n::: {#tbl-sep-model2 .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using the propensity score weighting approach (Separate weight models).' hash='chapter_07_cache/pdf/tbl-sep-model2_7014e6496cc6d33d8ab5892e085375b2'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrr}\n\\toprule\nValue of income & Est. & 2.5\\% & 97.5\\% & t val. & p\\\\\n\\midrule\n0 & 2.21 & 1.27 & 3.15 & 4.60 & 0\\\\\n1 & 1.34 & 0.85 & 1.83 & 5.36 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n### Weights from the subgroup balancing propensity scores\n\nSubgroup balancing propensity scores for propensity score weighting:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-43_4fecaf80c29fedf88c25b9731938b62e'}\n\n```{.r .cell-code}\nw.out <- weightit(smoking ~ age + gender + income, \n                data = Obs.Data,\n                method = \"ps\", estimand = \"ATT\")\nw.out.sb <- sbps(w.out, moderator = \"income\")\nd.w.sb <- svydesign(~1, weights = w.out.sb$weights, data = Obs.Data)\nfit2unadj.sb <- svyglm(hypertension ~ smoking*income, design = d.w.sb,\n                       family = binomial(\"logit\"))\nsb.w.nexp.adj.res <- sim_slopes(fit2unadj.sb, \n                              pred = smoking, \n                              modx = income, \n                              confint = TRUE,\n                              johnson_neyman = FALSE,)\n```\n:::\n\n::: {#tbl-w-balance .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using the subgroup balancing weighting approach.' hash='chapter_07_cache/pdf/tbl-w-balance_75fb1d4011df422c7faec3db01efb650'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & t val. & p\\\\\n\\midrule\n0 & 2.68 & 0.64 & 1.44 & 3.92 & 4.22 & 0\\\\\n1 & 1.32 & 0.25 & 0.82 & 1.82 & 5.22 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n\n## Covariate adjustment for the propensity score\n\n### As continuous covariate \n\nAn implementation of propensity scores as a continuous covariate in the outcome model:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-45_a92016612957851157c9abb97c956af1'}\n\n```{.r .cell-code}\n# Separate models for each subgroup\n\n# For subgroup income = 1 \nObs.Data$ps[Obs.Data$income == 1] <- glm(ps.formula, \n                                         data = subset(Obs.Data, income == 1), \n                                         family = \"binomial\")$fitted.values\nfit2adj1 <- glm(hypertension ~ smoking + age + gender, \n                family = binomial(\"logit\"), \n                data = subset(Obs.Data, income == 1))\n\n# For subgroup income = 0\nObs.Data$ps[Obs.Data$income == 0] <- glm(ps.formula, \n                                         data = subset(Obs.Data, income == 0), \n                                         family = \"binomial\")$fitted.values\nfit2adj0 <- glm(hypertension ~ smoking + age + gender, \n                family = binomial(\"logit\"), \n                data = subset(Obs.Data, income == 0))\n\nfit.nexp.adj.res1 <- summ(fit2adj1, robust = TRUE, confint = TRUE)\nfit.nexp.adj.res0 <- summ(fit2adj0, robust = TRUE, confint = TRUE)\n```\n:::\n\n::: {#tbl-cont-var .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using Propensity Score as a covariate adjustment approach (considering separate models for each subgroup).' hash='chapter_07_cache/pdf/tbl-cont-var_2e703e8310a8159ff7925be4f6ee6672'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrr}\n\\toprule\nValue of income & Est. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 1.16 & 0.56 & 1.75 & 3.83 & 0\\\\\n1 & 1.37 & 0.96 & 1.77 & 6.61 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-47_c82cef0a37de337e31fd5929f520c905'}\n\n```{.r .cell-code}\n# Common model\nObs.Data$ps <- glm(ps.formula.with.int, data = Obs.Data,\n                       family = \"binomial\")$fitted.values\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n:::\n\n```{.r .cell-code}\nfit2adjc <- glm(hypertension ~ smoking*income + age + gender + ps, \n                family = binomial(\"logit\"), \n                data = Obs.Data)\nc.nexp.adj.res <- sim_slopes(fit2adjc,\n                             pred = smoking, modx = income,\n                             confint = TRUE,\n                             data = Obs.Data)\n```\n:::\n\n::: {#tbl-cont-var2 .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using Propensity Score as a covariate adjustment approach (considering a common model).' hash='chapter_07_cache/pdf/tbl-cont-var2_cc9f5f14f0cabbd85038813b3f503ec4'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 1.17 & 0.29 & 0.61 & 1.74 & 4.07 & 0\\\\\n1 & 1.43 & 0.23 & 0.98 & 1.87 & 6.30 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n### As quantiles\n\nThe propensity scores as a categorical covariate, broken by quintiles, in the outcome model.\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-49_81da12c7b83fe5f815bf77f105bcb424'}\n\n```{.r .cell-code}\nObs.Data$ps <- glm(ps.formula.with.int, \n                   data = Obs.Data, \n                   family = \"binomial\")$fitted.values\nquintiles <- quantile(Obs.Data$ps, \n                      prob = seq(from = 0, to = 1, by = 0.2), \n                      na.rm = T)\nObs.Data$psq <- cut(Obs.Data$ps, breaks = quintiles, \n                   labels = seq(1,5), include.lowest = T)\nObs.Data$psq <- as.factor(Obs.Data$psq)\n\nfit2adjq <- glm(hypertension ~ (smoking*psq)*income, \n                family = binomial(\"logit\"),\n                data = Obs.Data)\ncq.nexp.adj.res <- sim_slopes(fit2adjq, \n                              pred = smoking, \n                              modx = income, \n                              confint = TRUE,\n                              data = Obs.Data)\n```\n:::\n\n::: {#tbl-cont-q .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using Propensity Score as a covariate adjustment approach (as quintiles).' hash='chapter_07_cache/pdf/tbl-cont-q_1e9bdde04083a811a5f1354b91043d9b'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 3.08 & 0.63 & 1.85 & 4.32 & 4.91 & 0\\\\\n1 & 2.60 & 0.47 & 1.68 & 3.51 & 5.56 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n## Propensity Score Stratification\nHere is an implementation of propensity score stratification approach by using the marginal mean weighting through stratification (MMWS):\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-51_c5bc61ab502629c1c729d7202187f973'}\n\n```{.r .cell-code}\nmatch.obj <- matchit(ps.formula, data = Obs.Data,\n                      method = \"subclass\", subclass = 3, \n                      estimand = \"ATT\", min.n = 10)\ndata.subclass <- match.data(match.obj)\nsubclass.fit <- glm(hypertension ~ smoking*income, family = binomial(\"logit\"),\n              data = data.subclass,\n              weights = weights)\nsubclass.nexp.adj.res <- sim_slopes(subclass.fit, \n                                    pred = smoking, \n                                    modx = income, \n                                    confint = TRUE,\n                                    robust = \"HC3\",\n                                    johnson_neyman = FALSE,\n                                    data = data.subclass)\n```\n:::\n\n::: {#tbl-s-mmws .cell tbl-cap='Subgroup-specific exposure effect estimates (expressed in log-OR) from the hypothetical example using propensity score stratification approach.' hash='chapter_07_cache/pdf/tbl-s-mmws_a1dd778a97e14e0f955dde35be66f726'}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\begin{tabular}{rrrrrrr}\n\\toprule\nValue of income & Est. & S.E. & 2.5\\% & 97.5\\% & z val. & p\\\\\n\\midrule\n0 & 2.21 & 0.47 & 1.29 & 3.13 & 4.71 & 0\\\\\n1 & 1.89 & 0.19 & 1.51 & 2.26 & 9.78 & 0\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\n## Summary\nThe marginal odds ratios for `smoking` are summarized below\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-53_4d07654d062e77369b746824f0aabeab'}\n::: {.cell-output-display}\n![](chapter_07_files/figure-pdf/unnamed-chunk-53-1.pdf)\n:::\n:::\n\n\n\n## Version info {.unnumbered}\nThis chapter was rendered using the following version of R and its packages:\n\n\n\n::: {.cell hash='chapter_07_cache/pdf/unnamed-chunk-54_c57ed620fcb0dddfe30c928d018c8b80'}\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.4\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/Zurich\ntzcode source: internal\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] scales_1.2.1       ggplot2_3.4.2      interactionR_0.1.6 simcausal_0.5.6   \n [5] xtable_1.8-4       dplyr_1.1.2        kableExtra_1.3.4   knitr_1.42        \n [9] cowplot_1.1.1      readstata13_0.10.1 Publish_2023.01.17 prodlim_2023.03.31\n[13] survey_4.2-1       survival_3.5-5     Matrix_1.5-4       broom_1.0.4       \n[17] MatchIt_4.5.4      interactions_1.1.5 jtools_2.2.1       sandwich_3.0-2    \n[21] lmtest_0.9-40      zoo_1.8-12         optmatch_0.10.6    WeightIt_0.14.2   \n[25] cobalt_4.5.1       table1_1.4.3      \n\nloaded via a namespace (and not attached):\n [1] DBI_1.1.3               rlemon_0.2.1            rlang_1.1.1            \n [4] magrittr_2.0.3          compiler_4.3.0          systemfonts_1.0.4      \n [7] vctrs_0.6.2             rvest_1.0.3             stringr_1.5.0          \n[10] httpcode_0.3.0          pkgconfig_2.0.3         crayon_1.5.2           \n[13] fastmap_1.1.1           backports_1.4.1         ellipsis_0.3.2         \n[16] labeling_0.4.2          pander_0.6.5            utf8_1.2.3             \n[19] promises_1.2.0.1        rmarkdown_2.21          ragg_1.2.5             \n[22] purrr_1.0.1             xfun_0.39               jsonlite_1.8.4         \n[25] later_1.3.1             chk_0.9.0               uuid_1.1-0             \n[28] parallel_4.3.0          R6_2.5.1                stringi_1.7.12         \n[31] car_3.1-2               parallelly_1.36.0       Rcpp_1.0.10            \n[34] assertthat_0.2.1        future.apply_1.11.0     httpuv_1.6.11          \n[37] splines_4.3.0           igraph_1.4.3            tidyselect_1.2.0       \n[40] abind_1.4-5             rstudioapi_0.14         yaml_2.3.7             \n[43] codetools_0.2-19        curl_5.0.0              listenv_0.9.0          \n[46] lattice_0.21-8          tibble_3.2.1            withr_2.5.0            \n[49] shiny_1.7.4             flextable_0.9.1         askpass_1.1            \n[52] evaluate_0.21           future_1.32.0           zip_2.3.0              \n[55] xml2_1.3.4              pillar_1.9.0            carData_3.0-5          \n[58] generics_0.1.3          munsell_0.5.0           globals_0.16.2         \n[61] glue_1.6.2              gdtools_0.3.3           tools_4.3.0            \n[64] gfonts_0.2.0            data.table_1.14.8       webshot_0.5.4          \n[67] mvtnorm_1.1-3           tidyr_1.3.0             mitools_2.4            \n[70] colorspace_2.1-0        Formula_1.2-5           cli_3.6.1              \n[73] textshaping_0.3.6       officer_0.6.2           expm_0.999-7           \n[76] fontBitstreamVera_0.1.1 fansi_1.0.4             viridisLite_0.4.2      \n[79] svglite_2.1.1           lava_1.7.2.1            gtable_0.3.3           \n[82] digest_0.6.31           fontquiver_0.2.1        msm_1.7                \n[85] crul_1.4.0              farver_2.1.1            htmltools_0.5.5        \n[88] lifecycle_1.0.3         httr_1.4.6              mime_0.12              \n[91] fontLiberation_0.1.0    openssl_2.0.6          \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}